function e(e,t){var a,o=document.getElementById(e),l=o.scrollTop,n=0,c=o.selectionStart||"0"===o.selectionStart?"ff":!!document.selection&&"ie";"ie"===c?(o.focus(),(a=document.selection.createRange()).moveStart("character",-o.value.length),n=a.text.length):"ff"===c&&(n=o.selectionStart);var r=o.value.substring(0,n),s=o.value.substring(n,o.value.length);o.value=r+t+s,n+=t.length,"ie"===c?(o.focus(),(a=document.selection.createRange()).moveStart("character",-o.value.length),a.moveStart("character",n),a.moveEnd("character",0),a.select()):"ff"===c&&(o.selectionStart=n,o.selectionEnd=n,o.focus()),o.scrollTop=l}function t(){$("#email-template-preview").contents().find("body").html($(".email-template-body").val())}const a=document.querySelector('meta[name="csrf_token_name"]').getAttribute("content"),o=document.querySelector('meta[name="csrf_cookie_name"]').getAttribute("content");parseInt(document.querySelector('meta[name="legacy_calculation"]').getAttribute("content")),$(function(){$.ajaxPrefilter(function(e){"post"!==e.type&&"POST"!==e.type&&"Post"!==e.type||(""===e.data?e.data+="?"+a+"="+Cookies.get(o):e.data+="&"+a+"="+Cookies.get(o))}),$(document).ajaxComplete(function(){$('[name="'+a+'"]').val(Cookies.get(o))}),$("form").on("submit",function(){$('input[name="'+a+'"]').prop("value",Cookies.get(o))}),$.fn.select2.defaults.set("selectionCssClass",":all:");var l=$("#content"),n=$("html"),c=n.outerHeight()-$(".navbar").outerHeight()-$("#headerbar").outerHeight()-$("#submenu").outerHeight();l.outerHeight()<c&&l.outerHeight(c),n.click(function(){$(".dropdown-menu:visible").not(".datepicker").removeAttr("style")}),$('[data-toggle="tooltip"]').tooltip(),$(".simple-select").select2(),$("select.multiple-select").select2().on("select2:select",function(e){if(""==$(e.params.data.element).val())$(this).val("").trigger("change.select2");else{var t=$(this).select2("val");t.length&&""==t[0]&&$(this).val(t.slice(1)).trigger("change.select2")}}).on("select2:unselect",function(e){$(this).select2("val").length||$(this).val("").trigger("change.select2")}),new ClipboardJS(".to-clipboard"),$(".taggable").on("focus",function(){window.lastTaggableClicked=this}),$(".tag-select").select2().on("change",function(t){var a=$(t.currentTarget);return void 0!==window.lastTaggableClicked&&e(window.lastTaggableClicked.id,a.val()),a.val([]),!1}),$(".html-tag").click(function(){!function(a,o){var l,n,c,r,s,i,d,u;switch(a){case"text-bold":l=["<b>","</b>"];break;case"text-italic":l=["<em>","</em>"];break;case"text-paragraph":l=["<p>","</p>"];break;case"text-linebreak":l=["<br>",""];break;case"text-h1":l=["<h1>","</h1>"];break;case"text-h2":l=["<h2>","</h2>"];break;case"text-h3":l=["<h3>","</h3>"];break;case"text-h4":l=["<h4>","</h4>"];break;case"text-code":l=["<code>","</code>"];break;case"text-hr":l=["<hr/>",""];break;case"text-css":l=["<style></style>",""]}n=document.getElementById(o),void 0!==document.selection?(n.focus(),c=document.selection.createRange().text):""!==n.selectionStart&&(r=n.selectionStart,s=n.selectionEnd,c=n.value.substring(r,s)),"text-css"===a?(i=l[0]+"\n\r"+n.value,$(n).val(i),t()):0===l[1].length?(e(o,l[0]),t()):c&&c.length?(d=l[0]+c+l[1],u=n.value.length,i=n.value.substring(0,r)+d+n.value.substring(s,u),$(n).val(i),t()):(e(o,l=l[0]+l[1]),t())}($(this).data("tagType"),$(".email-template-body").attr("id"))});var r=$(".email-template-body").attr("id");$("#email_template_preview").empty()&&t(),$(r).bind("input propertychange",function(){t()}),$("#email-template-preview-reload").click(function(){t()}),window.fullpage_loader=$("#fullpage-loader"),window.loader_error=$("#loader-error"),window.loader_icon=$("#loader-icon"),window.reset_loader=function(){loader_error.hide(),loader_icon.addClass("fa-spin").removeClass("text-danger"),clearTimeout(window.fullpageloaderTimeout)},window.close_loader=function(){fullpage_loader.fadeOut(200),reset_loader()},window.show_loader=function(e){e=e?parseInt(e):1e4,reset_loader(),fullpage_loader.fadeIn(200),window.fullpageloaderTimeout=window.setTimeout(function(){loader_error.fadeIn(200),loader_icon.removeClass("fa-spin").addClass("text-danger")},e)},$(document).on("click",".ajax-loader",function(){const e=$(this).closest("form");e.length&&!e[0].checkValidity()||show_loader()}),$(document).on("click",".fullpage-loader-close",function(){close_loader()});var s=$(".passwordmeter-input");s&&s.on("input",function(){var e=zxcvbn(s.val());$(".passmeter-2, .passmeter-3").hide(),4===e.score?$(".passmeter-2, .passmeter-3").show():3===e.score&&$(".passmeter-2").show()}),$(document).on("keydown",function(e){e.ctrlKey&&"s"===e.key&&($(".modal-footer .btn-success:visible").length?(e.preventDefault(),$(".modal-footer .btn-success").click()):$("#headerbar .btn-success").length&&(e.preventDefault(),$("#headerbar .btn-success").click()))});const i=document.getElementById("settings[qr_code]"),d=document.getElementById("panel-qr-code-settings");i&&d&&i.addEventListener("click",()=>{d.querySelectorAll(".row").forEach(e=>{i.checked?e.classList.remove("hidden"):e.classList.add("hidden")})})});
